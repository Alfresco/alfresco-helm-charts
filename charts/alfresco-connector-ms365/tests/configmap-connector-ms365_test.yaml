---
suite: test connector-ms365 deployment
templates:
    - config-connector-ms365.yaml
tests:
    - it: should render just the URL in JAVA_OPTS
      values: &testvalues
      set:
       repository.host: acs-alfresco-cs-repository
       repository.port: 80
      asserts:
       - equal:
           path: data.JAVA_OPTS
           value: -Dalfresco.base-url=http://acs-alfresco-cs-repository:80
    - it: should render options based on repo nameOverride
      values: *testvalues
      set:
        repository:
            nameOverride: myKnownServiceName
            port: 80
      asserts:
       - matchRegex:
           path: data.JAVA_OPTS
           pattern: -Dalfresco.base-url=http://RELEASE-NAME-myKnownServiceName:80
    - it: should render options as provided in values
      values: *testvalues
      set:
        repository:
            host: somerepohost
            port: 80
      asserts:
       - matchRegex:
            path: data.JAVA_OPTS
            pattern: -Dalfresco.base-url=http://somerepohost:80
