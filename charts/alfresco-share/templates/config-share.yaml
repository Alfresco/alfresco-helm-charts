---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ template "alfresco-share.fullname" . }}-configmap
  labels:
    {{- include "alfresco-share.labels" . | nindent 4 }}
data:
  REPO_HOST: {{ .Values.repository.host | quote }}
  REPO_PORT: {{ .Values.repository.port | quote }}
  CSRF_FILTER_REFERER: {{ include "alfresco-share.csrf.referer" (.Values.global.known_urls | default "http://localhost,https://localhost") }}
  CSRF_FILTER_ORIGIN: {{ include "alfresco-share.csrf.origin" (.Values.global.known_urls | default "http://localhost,https://localhost") }}
  EXTERNAL_HOST: {{ include "alfresco-share.external.url" (.Values.global.known_urls | default "http://localhost,https://localhost") }}
  {{ toYaml (.Values.environment) }}
  JAVA_OPTS: >-
    {{ (printf "%s %s" (.Values.environment.JAVA_OPTS | default "") "-Dalfresco.proxy=$EXTERNAL_HOST") | trim | quote }}
